<html>
  <head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">  

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js"></script>    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  </head>
  <body>
  
    <script>
      console.log('begin grabbing code');
      
      function getParameterByName(name, url) {
        if (!url) url = window.location.href;
        name = name.replace(/[\[\]]/g, '\\$&');
        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
          results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
      }
      
      var p = getParameterByName('code');
      console.log(p);
      
      console.log('finished grabbing code');
      

      console.log('begin oauth token exchange');
      var contentType ="application/x-www-form-urlencoded; charset=utf-8";
      if(window.XDomainRequest) //for IE8,IE9
        contentType = "text/plain";
      var settings = {
        "method": "POST",
        "url": "https://admin.dev.carthook.com/oauth/token",
        "contentType": contentType,
        "grant_type": "authorization_code",
        "client_id": "5f16e868949262f1cdf1b0d9f06d2819",
        "client_secret": "OuRYYSUzcJc0XaSZ1KuMHoSuJQ7MrywHpYbCTyWP",
        "code": p,
        "redirect_uri": "https://ryansnyder.me/callback.html"
      }    
      console.log("=== SETTINGS ===");            
      console.log(settings);
      console.log("=== SETTINGS ===");
      $.ajax(settings).done(function (response) {
        console.log(response);
      });      
      console.log('finished oauth token exchange');      
    </script>  
  
    
  </body>
</html>
